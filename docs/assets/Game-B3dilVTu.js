import{m as ke,r as X,p as J,o as Ee,q as Xe,s as qe,c as $,h as z,f as T,w as Fe,t as M,g as te,l as xe,F as K,k as Q,n as He,j as _e}from"./index-XjHCpg4x.js";const j=[{id:"apple",emoji:"ğŸ",name:"è‹¹æœ",buyPrice:5,sellPrice:8,weight:2,boxSize:20,transportTime:5e3,demand:2.1},{id:"banana",emoji:"ğŸŒ",name:"é¦™è•‰",buyPrice:4,sellPrice:7,weight:1,boxSize:25,transportTime:1e3,demand:4.3},{id:"watermelon",emoji:"ğŸ‰",name:"è¥¿ç“œ",buyPrice:10,sellPrice:16,weight:8,boxSize:10,transportTime:7e3,demand:1.9},{id:"grape",emoji:"ğŸ‡",name:"è‘¡è„",buyPrice:6,sellPrice:10,weight:1,boxSize:25,transportTime:3e3,demand:1.3},{id:"melon",emoji:"ğŸˆ",name:"é¦™ç“œ",buyPrice:7,sellPrice:11,weight:5,boxSize:12,transportTime:4e3,demand:1},{id:"strawberry",emoji:"ğŸ“",name:"è‰è“",buyPrice:6,sellPrice:9,weight:1,boxSize:20,transportTime:3e3,demand:1.5},{id:"peach",emoji:"ğŸ‘",name:"æ¡ƒå­",buyPrice:7,sellPrice:10,weight:3,boxSize:18,transportTime:4e3,demand:1.2},{id:"mango",emoji:"ğŸ¥­",name:"èŠ’æœ",buyPrice:8,sellPrice:13,weight:4,boxSize:15,transportTime:4e3,demand:1.1},{id:"lemon",emoji:"ğŸ‹",name:"æŸ æª¬",buyPrice:4,sellPrice:7,weight:1,boxSize:20,transportTime:2e3,demand:1.3},{id:"kiwi",emoji:"ğŸ¥",name:"çŒ•çŒ´æ¡ƒ",buyPrice:7,sellPrice:11,weight:2,boxSize:20,transportTime:3500,demand:.2},{id:"pineapple",emoji:"ğŸ",name:"è è",buyPrice:9,sellPrice:14,weight:6,boxSize:8,transportTime:5e3,demand:.9},{id:"cherry",emoji:"ğŸ’",name:"æ¨±æ¡ƒ",buyPrice:10,sellPrice:16,weight:1,boxSize:30,transportTime:6e3,demand:1.6},{id:"pear",emoji:"ğŸ",name:"æ¢¨å­",buyPrice:6,sellPrice:9,weight:2,boxSize:20,transportTime:3e3,demand:1.2},{id:"hamburger",emoji:"ğŸ”",name:"æ±‰å ¡",buyPrice:8,sellPrice:13,weight:1,boxSize:25,transportTime:4500,demand:1.4},{id:"avocado",emoji:"ğŸ¥‘",name:"ç‰›æ²¹æœ",buyPrice:9,sellPrice:14,weight:5,boxSize:10,transportTime:5e3,demand:.8},{id:"greenapple",emoji:"ğŸ",name:"é’è‹¹æœ",buyPrice:5,sellPrice:8,weight:2,boxSize:20,transportTime:5e3,demand:1},{id:"tangerine",emoji:"ğŸŠ",name:"æ©˜å­",buyPrice:5,sellPrice:9,weight:2,boxSize:20,transportTime:3e3,demand:2.3},{id:"coconut",emoji:"ğŸ¥¥",name:"æ¤°å­",buyPrice:10,sellPrice:15,weight:6,boxSize:6,transportTime:6e3,demand:.7},{id:"corn",emoji:"ğŸŒ½",name:"ç‰ç±³",buyPrice:11,sellPrice:17,weight:7,boxSize:5,transportTime:7e3,demand:.6},{id:"bread",emoji:"ğŸ",name:"é¢åŒ…",buyPrice:7,sellPrice:12,weight:3,boxSize:18,transportTime:4500,demand:3}],Y=ke({money:2e3,carryingCapacity:50,incomingShipments:[],workerSpeed:3}),N=ke({level:1,exp:0});function Ge(c,u,_){const x=j.find(f=>f.id===c);if(!x)return{error:"å•†å“ä¸å­˜åœ¨"};const i=x.buyPrice*x.boxSize*u;if(_<u)return{error:"å…¥åº“åŒºç©ºé—´ä¸è¶³"};if(Y.money<i)return{error:"èµ„é‡‘ä¸è¶³"};Y.money-=i;const m=Date.now()+x.transportTime;return Y.incomingShipments.push({productId:c,boxCount:u,eta:m,startTime:Date.now()}),{success:!0}}function Le(c,u,_){const x=Date.now(),i=[];for(const m of Y.incomingShipments)m.eta<=x?Ze(c,u,_,m.productId,m.boxCount)||alert("å…¥åº“å¤±è´¥ï¼Œç©ºé—´ä¸è¶³"):i.push(m);Y.incomingShipments=i}function Ze(c,u,_,x,i){const m=j.find(v=>v.id===x);if(!m)return!1;let f=0;for(let v=0;v<c.length;v++)for(let d=0;d<c[0].length;d++){if(f>=i)return!0;const e=u[v][d],r=c[v][d];e===_&&r===null&&(c[v][d]={type:"goods",productId:x,count:m.boxSize},f++)}return f===i}function Ue(c,u,_){let x=0;for(let i=0;i<c.length;i++)for(let m=0;m<c[0].length;m++)u[i][m]===_&&c[i][m]===null&&x++;return x}const se=1,q=0,re=2,ie=3;function Ve(c,u){const _=j.slice(0,N.level+2);for(let x=0;x<u.length;x++)for(let i=0;i<u[0].length;i++)if(u[x][i]===1&&Math.random()<.05){const m=_[Math.floor(Math.random()*_.length)];c[x][i]={type:"goods",productId:m.id,count:Math.floor(m.boxSize*(Math.random()*.5+.5))}}}function Je(c,u){const _=Array.from({length:c},()=>Array(u).fill(q)),x=4,i=2,m=1,f=4;for(let v=0;v<x;v++){const d=f+v*(i+m);for(let e=d;e<d+i;e++)for(let r=1;r<=10;r++)_[e][r]=se;for(let e=d;e<d+i;e++)for(let r=15;r<=24;r++)_[e][r]=se;for(let e=d;e<d+i;e++)for(let r=u-11;r<=u-2;r++)_[e][r]=se;for(let e=18;e<=21;e++)_[0][e]=re;for(let e=18;e<=21;e++)_[c-1][e]=ie}return _}function Ke(c){return c.map(u=>({v:u,sort:Math.random()})).sort((u,_)=>u.sort-_.sort).map(({v:u})=>u)}let be=1;function Qe(){const u=`ORD-${new Date().toISOString().slice(0,10).replace(/-/g,"")}-${String(be).padStart(3,"0")}`;return be++,u}function Te(){const c=Math.floor(Math.random()*3)+1,_=j.slice(0,N.level+2).flatMap(m=>Array(Math.floor(m.demand*10)).fill(m)),i=[...new Set(Ke(_))].slice(0,c).map(m=>{const f=Math.ceil(Math.random()*m.boxSize);return{productId:m.id,count:f}});return{id:Qe(),items:i,expires:Date.now()+18e4}}function et(c,u,_){const x={};for(let f=0;f<u.length;f++)for(let v=0;v<u[0].length;v++)if(_[f][v]===ie){const d=u[f][v];if(d&&d.type==="goods"){const e=d.productId;x[e]=(x[e]||0)+d.count}}for(const f of c.items)if(!x[f.productId]||x[f.productId]<f.count)return{success:!1,reason:"åº“å­˜ä¸è¶³"};for(const f of c.items){let v=f.count;for(let d=0;d<u.length;d++){for(let e=0;e<u[0].length;e++)if(_[d][e]===ie){const r=u[d][e];if(r&&r.type==="goods"&&r.productId===f.productId){const O=Math.min(v,r.count);if(r.count-=O,v-=O,r.count<=0&&(u[d][e]=null),v<=0)break}}if(v<=0)break}}const i=c.items.reduce((f,v)=>{const d=j.find(e=>e.id===v.productId);return f+((d==null?void 0:d.sellPrice)||0)*v.count},0),m=Math.floor(c.items.reduce((f,v)=>{var e;const d=((e=j.find(r=>r.id===v.productId))==null?void 0:e.demand)||1;return f+1/d*10},0)+Math.random()*10);return Y.money+=i+m,{success:!0,earned:i,bonus:m,total:i+m}}function tt(c,u,_,x,i,m,f,v,d){for(let e=0;e<m;e++)for(let r=0;r<f;r++){const O=(r-x.x)*i,A=(e-x.y)*i;if(O+i<0||O>v||A+i<0||A>d)continue;const Z=u[e][r],W=_[e][r];switch(Z){case 1:c.fillStyle="#888";break;case 2:c.fillStyle="#aaf";break;case 3:c.fillStyle="#afa";break;default:c.fillStyle="#f0f0f0";break}if(c.fillRect(O,A,i,i),c.strokeStyle="#ccc",c.strokeRect(O,A,i,i),(W==null?void 0:W.type)==="goods"){const ee=j.find(F=>F.id===W.productId);ee&&(c.font=`${i*.6}px serif`,c.textAlign="center",c.textBaseline="middle",c.fillText(ee.emoji,O+i*.5,A+i*.5),c.font="12px sans-serif",c.textAlign="right",c.textBaseline="bottom",c.fillStyle="#fff",c.fillRect(O+i-28,A+i-18,26,16),c.fillStyle="#000",c.fillText(`Ã—${W.count}`,O+i-4,A+i-4))}}}const ne=[{level:1,expNeeded:100,expTotal:100},{level:2,expNeeded:120,expTotal:220},{level:3,expNeeded:144,expTotal:364},{level:4,expNeeded:172,expTotal:536},{level:5,expNeeded:207,expTotal:743},{level:6,expNeeded:248,expTotal:991},{level:7,expNeeded:298,expTotal:1289},{level:8,expNeeded:358,expTotal:1647},{level:9,expNeeded:429,expTotal:2076},{level:10,expNeeded:515,expTotal:2591},{level:11,expNeeded:619,expTotal:3210},{level:12,expNeeded:743,expTotal:3953},{level:13,expNeeded:891,expTotal:4844},{level:14,expNeeded:1069,expTotal:5913},{level:15,expNeeded:1283,expTotal:7196},{level:16,expNeeded:1540,expTotal:8736},{level:17,expNeeded:1848,expTotal:10584},{level:18,expNeeded:2218,expTotal:12802},{level:19,expNeeded:2662,expTotal:15464},{level:20,expNeeded:3194,expTotal:18658}],nt={class:"sidebar"},ot={class:"level-bar"},lt={class:"money-display"},at={class:"tabs"},st=["onClick"],rt={class:"sidebar-content"},it={key:0},ct={key:0},ut=["title"],dt={class:"name"},ft={class:"note"},vt=["onClick"],pt={key:1,class:"locked"},mt={key:1,style:{padding:"16px"}},gt={class:"order-header"},ht={class:"order-items"},yt={class:"order-bonus"},xt={class:"order-total"},_t=["onClick"],bt={class:"progress-bar"},Tt={key:2},kt=["title"],wt={class:"emoji"},Pt={class:"count-overlay"},St={class:"name"},Mt={class:"value"},It={class:"inventory-total"},I=40,D=20,B=40,Ct={__name:"Game",setup(c){const u=X(null);let _=800,x=512,i=0,m=0;const f=X({x:0,y:0}),v=X(Je(D,B)),d=X(Array.from({length:D},()=>Array(B).fill(null))),e=X({gx:6,gy:6,px:0,py:0,path:[],carrying:null,target:null,message:null,messageType:"error",messageTimer:0});let r=null,O=null,A=0,Z=0;const W=X(null),ee=["å…¥åº“","å‡ºåº“","åº“å­˜"],F=X("å…¥åº“"),oe=X(Y.money);J(()=>j.slice(0,N.level+2));const H=X([]),ce=J(()=>{const t=ne.find(o=>o.level===N.level);return(t==null?void 0:t.expNeeded)||99999}),we=J(()=>Math.min(100,N.exp/ce.value*100));function Pe(t){for(N.exp+=t;N.level<ne.length&&N.exp>=ne[N.level-1].expNeeded;)N.exp-=ne[N.level-1].expNeeded,N.level++,Y.workerSpeed+=1,L("Level upï¼","success")}function ue(){const n=3e4*Math.exp(-.15*(N.level-1));return Math.max(1e3,Math.floor(n))}function U(t){return j.find(o=>o.id===t)||{}}function de(t){const n=t.items.reduce((a,s)=>{const p=U(s.productId).demand||1;return a+Math.floor(1/p*10)},0),l=t.items.length*5;return 5+n+l}function Se(t){return t.items.reduce((n,l)=>{const a=U(l.productId).sellPrice||0;return n+l.count*a},0)+de(t)}function Me(t){const n=t.expires-Date.now();return 100-Math.min(100,Math.max(0,(18e4-n)/18e4*100))}const Ie=J(()=>Object.values(fe.value).reduce((t,o)=>t+o.value,0));function je(){function t(){const o=Te();H.value.push(o);const n=Math.floor(Math.random()*1e4)+ue();setTimeout(t,n)}H.value=[Te()],setTimeout(t,ue())}setInterval(()=>{const t=Date.now();H.value=H.value.filter(o=>o.expires>t)},1e3);const fe=J(()=>{const t={};for(let o of d.value)for(let n of o)if(G(n)){const l=j.find(s=>s.id===n.productId);if(!l)continue;const a=l.boxSize;t[l.id]?(t[l.id].count+=a,t[l.id].value+=a*l.sellPrice):t[l.id]={count:a,emoji:l.emoji,name:l.name,value:a*l.sellPrice}}return t});function ve(t){const o=j.find(n=>n.name===t);return o?`åç§°: ${o.name}
  æ¯ç®±: ${o.boxSize}ä¸ª
  é‡é‡: ${o.weight}
  è¿›ä»·: Â¥${o.buyPrice}
  å”®ä»·: Â¥${o.sellPrice}
  è¿è¾“: ${o.transportTime/1e3}s
  éœ€æ±‚æŒ‡æ•°: ${o.demand}`:""}function Ce(t){const o=Ue(d.value,v.value,re),n=Ge(t,1,o);n.error&&alert(n.error)}function Ne(){const t=i/2,o=m/2,n=e.value.gx,l=e.value.gy;let a=n-t,s=l-o;a<0&&(a=0),a>B-i&&(a=B-i),s<0&&(s=0),s>D-m&&(s=D-m);const p=(g,h,b)=>g+(h-g)*b,y=.1;f.value.x=p(f.value.x,a,y),f.value.y=p(f.value.y,s,y)}function $e(){const t=e.value.px-f.value.x*I,o=e.value.py-f.value.y*I;if(r.font=`${I*.9}px serif`,r.textAlign="center",r.textBaseline="middle",r.fillText("ğŸ‘·",t,o),e.value.message&&e.value.messageTimer>0&&(Be(r,e.value.message,t,o,e.value.messageType),e.value.messageTimer--,e.value.messageTimer===0&&(e.value.message=null)),e.value.carrying){const n=j.find(l=>l.id===e.value.carrying.productId);n&&(r.font="20px serif",r.fillText(n.emoji,t,o+14),r.fillStyle="#fff",r.fillRect(t+10,o+15,26,14),r.font="10px sans-serif",r.fillStyle="#000",r.fillText(`Ã—${e.value.carrying.count}`,t+22,o+24))}}function ze(){const t=Date.now(),o=120,n=16;Y.incomingShipments.forEach((l,a)=>{const s=j.find(k=>k.id===l.productId);if(!s)return;const p=l.eta-(l.startTime||l.eta-s.transportTime),g=1-(l.eta-t)/p,h=_-150,b=30+a*(n+10);r.fillStyle="#ddd",r.fillRect(h,b,o,n),r.fillStyle="#76c7c0",r.fillRect(h,b,o*g,n),r.font="16px serif",r.fillStyle="#000",r.fillText(s.emoji+" Ã—"+l.boxCount,h-80,b+14)})}function pe(){var t;if(r.clearRect(0,0,u.value.width,u.value.height),tt(r,v.value,d.value,f.value,I,D,B,_,x),Re(),Ne(),$e(),ze(),Le(d.value,v.value,re),O=requestAnimationFrame(pe),e.value.target){const[o,n]=e.value.target,l=(t=d.value[n])==null?void 0:t[o],a=e.value.__targetMode,s=e.value.carrying;if(a==="pickup"){if(!G(l)){e.value.target=null;return}if(e.value.__tick||(e.value.__tick=0),e.value.__tick++,e.value.__tick>=5){const p=l.productId;j.find(g=>g.id===p)&&(s?s.count++:e.value.carrying={productId:p,count:1},l.count--,l.count<=0&&(d.value[n][o]=null,e.value.target=null)),e.value.__tick=0}}else if(a==="dropoff"){if(!s){e.value.target=null;return}const p=j.find(y=>y.id===s.productId);if(!p)return;if(e.value.__tick||(e.value.__tick=0),e.value.__tick++,e.value.__tick>=5){if(G(l)){if(l.productId!==s.productId){L("å•†å“ç±»å‹ä¸ä¸€è‡´"),e.value.target=null;return}if(l.count>=p.boxSize){L("æ­¤æ ¼å·²æ»¡"),e.value.target=null;return}l.count++}else d.value[n][o]={type:"goods",productId:s.productId,count:1};s.count--,s.count<=0&&(e.value.carrying=null,e.value.target=null),e.value.__tick=0}}}if(W.value){const{x:o,y:n,productId:l}=W.value,a=j.find(s=>s.id===l);if(a){const p=`
      ${a.name}
      è¿›ä»·: Â¥${a.buyPrice}
      å”®ä»·: Â¥${a.sellPrice}
      é‡é‡: ${a.weight}
      `.split(`
`),y=p.length*18+10;r.fillStyle="rgba(0,0,0,0.75)",r.fillRect(o+10,n+10,80,y),r.fillStyle="#fff",r.font="13px sans-serif",p.forEach((g,h)=>{r.fillText(g,o+36,n+28+h*16)})}}}function me(){var g;const{gx:t,gy:o}=e.value,n=e.value.__targetGoods;if(!n)return;const[l,a]=n,s=Math.abs(t-l),p=Math.abs(o-a),y=(g=d.value[a])==null?void 0:g[l];(s===1&&p===0||s===0&&p===1)&&(e.value.__targetMode==="pickup"&&G(y)&&y.count>0&&(e.value.target=[l,a],e.value.__tick=0),e.value.__targetMode==="dropoff"&&e.value.carrying&&(e.value.target=[l,a],e.value.__tick=0)),console.log("afterArrivedTile",e.value.target,e.value.__targetGoods,e.value.carrying),e.value.__targetGoods=null}function Re(){const t=Y.workerSpeed;if(e.value.path.length>0){const[o,n]=e.value.path[0],l=o*I+I/2,a=n*I+I/2,s=l-e.value.px,p=a-e.value.py,y=Math.sqrt(s*s+p*p);if(y<t){if(e.value.px=l,e.value.py=a,e.value.gx=o,e.value.gy=n,e.value.gx<0||e.value.gy<0||e.value.gx>=B||e.value.gy>=D){console.warn("å·¥äººè¶Šç•Œ:",e.value.gx,e.value.gy),e.value.path=[];return}e.value.path.shift(),me()}else e.value.px+=s/y*t,e.value.py+=p/y*t}}function Oe(t){const o=et(t,d.value,v.value);o.success?(H.value=H.value.filter(n=>n.id!==t.id),Pe(o.total)):L("å°šæœªæ»¡è¶³è®¢å•æ¡ä»¶ï¼")}function ge(t,o,n){const a=[[t+1,o],[t-1,o],[t,o+1],[t,o-1]].filter(([h,b])=>h>=0&&b>=0&&h<B&&b<D&&v.value[b][h]===q),{gx:s,gy:p}=e.value;for(const[h,b]of a)if(h===s&&b===p){e.value.__targetGoods=[t,o],e.value.__targetMode=n,e.value.path=[],me(),console.log(e.value.__targetGoods,e.value.__targetMode,e.value.path);return}let y=null,g=[];for(const[h,b]of a){const k=ae([e.value.gx,e.value.gy],[h,b]);k.length&&(!y||k.length<g.length)&&(y=[h,b],g=k)}e.value.__targetGoods=[t,o],e.value.__targetMode=n,y&&g&&(e.value.path=g)}function le(t){var k,w;const o=u.value.getBoundingClientRect(),n=t.clientX-o.left,l=t.clientY-o.top,a=Math.floor(n/I+f.value.x),s=Math.floor(l/I+f.value.y);if(a<0||s<0||a>=B||s>=D){console.warn("å·¥äººè¶Šç•Œ:",a,s);return}let p=a,y=s;if(((k=v.value[s])==null?void 0:k[a])!==q){const P=[[a+1,s],[a-1,s],[a,s+1],[a,s-1]];let S=null,E=[];for(const[R,C]of P)if(R>=0&&C>=0&&R<B&&C<D&&v.value[C][R]===q){const V=ae([e.value.gx,e.value.gy],[R,C]);V.length&&(!S||V.length<E.length)&&(S=[R,C],E=V)}S?(p=S[0],y=S[1]):console.warn("æ²¡æœ‰å¯è¾¾è·¯å¾„")}e.value.target=null;const g=(w=d.value[s])==null?void 0:w[a],h=e.value.carrying;if(G(g)){console.warn("isGoodsCell",h),!h||h.productId===g.productId?ge(a,s,"pickup"):L("å•†å“ç±»å‹ä¸ä¸€è‡´");return}const b=ae([e.value.gx,e.value.gy],[p,y]);b.length>0&&(e.value.path=b)}function Ae(t){var b,k;t.preventDefault();const o=u.value.getBoundingClientRect(),n=t.clientX-o.left,l=t.clientY-o.top,a=Math.floor(n/I+f.value.x),s=Math.floor(l/I+f.value.y);if(a<0||s<0||a>=B||s>=D){console.warn("å·¥äººè¶Šç•Œ:",a,s);return}const p=(b=v.value[s])==null?void 0:b[a],y=(k=d.value[s])==null?void 0:k[a],g=e.value.carrying;if(p===q||!g)return;if(!(y==null||y.type==="goods"&&y.productId===g.productId)){L("å•†å“ç±»å‹ä¸ä¸€è‡´");return}ge(a,s,"dropoff")}function De(t){var s;const o=u.value.getBoundingClientRect();A=t.clientX-o.left,Z=t.clientY-o.top;const n=Math.floor(A/I+f.value.x),l=Math.floor(Z/I+f.value.y),a=(s=d.value[l])==null?void 0:s[n];G(a)?W.value={x:A,y:Z,productId:a.productId}:W.value=null}function ae(t,o){const[n,l]=t,[a,s]=o,p=[[n,l]],y={},g={},h=(w,P)=>`${w},${P}`;for(y[h(n,l)]=null,g[h(n,l)]=0;p.length;){p.sort((S,E)=>g[h(S[0],S[1])]+he(S,o)-(g[h(E[0],E[1])]+he(E,o)));const[w,P]=p.shift();if(w===a&&P===s)break;for(const[S,E]of[[1,0],[-1,0],[0,1],[0,-1],[1,1],[-1,1],[1,-1],[-1,-1]]){const R=w+S,C=P+E;if(R<0||C<0||R>=B||C>=D||v.value[C][R]!==q)continue;if(Math.abs(S)+Math.abs(E)===2){const Ye=v.value[P][C]!==q,We=v.value[C][w]!==q;if(Ye||We)continue}const V=S===0||E===0?1:1.4,ye=g[h(w,P)]+V;(!(h(R,C)in g)||ye<g[h(R,C)])&&(g[h(R,C)]=ye,y[h(R,C)]=[w,P],p.push([R,C]))}}const b=[];let k=[a,s];for(;k&&h(k[0],k[1])!==h(n,l);)b.unshift(k),k=y[h(k[0],k[1])];return b}function he(t,o){return Math.abs(t[0]-o[0])+Math.abs(t[1]-o[1])}function G(t){return t&&typeof t=="object"&&t.type==="goods"}function L(t,o="error",n=60){e.value.message=t,e.value.messageTimer=n,e.value.messageType=o}function Be(t,o,n,l,a="error"){const g=`${a==="success"?"ğŸ˜„":"âŒ"} ${o}`;t.font="14px sans-serif";const b=t.measureText(g).width+8*2,k=22,w=n-b/2,P=l-60,S=6;t.beginPath(),t.moveTo(w+S,P),t.lineTo(w+b-S,P),t.quadraticCurveTo(w+b,P,w+b,P+S),t.lineTo(w+b,P+k-S),t.quadraticCurveTo(w+b,P+k,w+b-S,P+k),t.lineTo(w+S,P+k),t.quadraticCurveTo(w,P+k,w,P+k-S),t.lineTo(w,P+S),t.quadraticCurveTo(w,P,w+S,P),t.closePath(),t.fillStyle=a==="success"?"rgba(240,255,240,0.95)":"rgba(255,255,255,0.95)",t.fill(),t.strokeStyle=a==="success"?"#4caf50":"#999",t.stroke(),t.fillStyle="#000",t.textAlign="center",t.textBaseline="middle",t.fillText(g,n,P+k/2)}return Ee(()=>{_=window.innerWidth-500,x=window.innerHeight-100,u.value.width=_,u.value.height=x,i=Math.floor(_/I),m=Math.floor(x/I),r=u.value.getContext("2d"),e.value.px=e.value.gx*I+I/2,e.value.py=e.value.gy*I+I/2,u.value.addEventListener("click",le),Ve(d.value,v.value),pe(),je()}),Xe(()=>{cancelAnimationFrame(O),u.value.removeEventListener("click",le)}),qe(()=>Y.money,(t,o)=>{const a=16.666666666666668,s=(t-o)/30;let p=o,y=0;const g=setInterval(()=>{p+=s,oe.value=Math.round(p),y++,y>=30&&(oe.value=t,clearInterval(g))},a)}),(t,o)=>(z(),$("div",{class:"warehouse-canvas-game",onMousemove:De},[T("canvas",{ref_key:"canvasRef",ref:u,onClick:le,onContextmenu:Fe(Ae,["prevent"])},null,544),T("div",nt,[T("h3",null,"ğŸ–ï¸ ç­‰çº§ï¼š"+M(te(N).level),1),T("p",null,"ç»éªŒå€¼ï¼š"+M(te(N).exp)+" / "+M(ce.value),1),T("div",ot,[T("div",{class:"level-bar-inner",style:xe({width:we.value+"%"})},null,4)]),T("div",lt,"ğŸ’°èµ„é‡‘: Â¥"+M(oe.value),1),T("div",at,[(z(),$(K,null,Q(ee,n=>T("button",{key:n,onClick:l=>F.value=n,class:He({active:F.value===n})},M(n),11,st)),64))]),T("div",rt,[F.value==="å…¥åº“"?(z(),$("div",it,[(z(!0),$(K,null,Q(te(j),(n,l)=>(z(),$("div",{key:n.id,class:"product-entry"},[l<=te(N).level+1?(z(),$("div",ct,[T("span",{class:"emoji",title:ve(n.name)},M(n.emoji),9,ut),T("span",dt,M(n.name),1),T("span",ft,M(n.boxSize)+"ä¸ª/ç®±",1),T("button",{class:"price-btn",onClick:a=>Ce(n.id)},"Â¥"+M(n.boxSize*n.buyPrice),9,vt)])):(z(),$("div",pt," ğŸ”’ "+M(n.name)+"ï¼ˆLv."+M(l-2)+" è§£é”ï¼‰ ",1))]))),128))])):_e("",!0),F.value==="å‡ºåº“"?(z(),$("div",mt,[(z(!0),$(K,null,Q(H.value,n=>(z(),$("div",{key:n.id,class:"order-card"},[T("div",gt,[T("span",null,"ğŸ§¾ è®¢å• "+M(n.id),1)]),T("div",ht,[(z(!0),$(K,null,Q(n.items,l=>(z(),$("div",{key:l.productId,class:"order-item"},[T("span",null,M(U(l.productId).emoji)+M(U(l.productId).name),1),T("span",null,"Â¥ "+M(U(l.productId).sellPrice),1),T("span",null,"Ã— "+M(l.count),1)]))),128))]),T("div",yt,"ğŸ å¥–é‡‘: Â¥"+M(de(n)),1),T("div",xt,"ğŸ’µ æ€»æ”¶å…¥: Â¥"+M(Se(n)),1),T("button",{class:"complete-btn",onClick:l=>Oe(n)}," Â Â Â å®ŒæˆÂ Â Â  ",8,_t),T("div",bt,[T("div",{class:"progress-fill",style:xe({width:Me(n)+"%"})},null,4)])]))),128))])):F.value==="åº“å­˜"?(z(),$("div",Tt,[(z(!0),$(K,null,Q(fe.value,(n,l)=>(z(),$("div",{key:l,class:"stock-line"},[T("div",{class:"emoji-wrapper",title:ve(n.name)},[T("span",wt,M(n.emoji),1),T("span",Pt,"Ã—"+M(n.count),1)],8,kt),T("span",St,M(n.name),1),T("span",Mt,"ä¼°å€¼: Â¥"+M(n.value),1)]))),128)),T("div",It," ğŸ’° æ€»ä¼°å€¼: Â¥"+M(Ie.value),1)])):_e("",!0)])])],32))}};export{Ct as default};
