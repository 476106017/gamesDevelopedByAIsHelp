import{m as we,r as X,p as J,o as Ee,q as Xe,s as qe,c as $,h as z,f as b,w as Fe,t as M,g as te,l as xe,F as K,k as Q,n as He,j as _e}from"./index-CPr-TiJ5.js";const j=[{id:"apple",emoji:"ğŸ",name:"è‹¹æœ",buyPrice:5,sellPrice:8,weight:2,boxSize:20,transportTime:5e3,demand:2.1},{id:"banana",emoji:"ğŸŒ",name:"é¦™è•‰",buyPrice:4,sellPrice:7,weight:1,boxSize:25,transportTime:1e3,demand:4.3},{id:"watermelon",emoji:"ğŸ‰",name:"è¥¿ç“œ",buyPrice:10,sellPrice:16,weight:8,boxSize:10,transportTime:7e3,demand:1.9},{id:"grape",emoji:"ğŸ‡",name:"è‘¡è„",buyPrice:6,sellPrice:10,weight:1,boxSize:25,transportTime:3e3,demand:1.3},{id:"melon",emoji:"ğŸˆ",name:"é¦™ç“œ",buyPrice:7,sellPrice:11,weight:5,boxSize:12,transportTime:4e3,demand:1},{id:"strawberry",emoji:"ğŸ“",name:"è‰è“",buyPrice:6,sellPrice:9,weight:1,boxSize:20,transportTime:3e3,demand:1.5},{id:"peach",emoji:"ğŸ‘",name:"æ¡ƒå­",buyPrice:7,sellPrice:10,weight:3,boxSize:18,transportTime:4e3,demand:1.2},{id:"mango",emoji:"ğŸ¥­",name:"èŠ’æœ",buyPrice:8,sellPrice:13,weight:4,boxSize:15,transportTime:4e3,demand:1.1},{id:"lemon",emoji:"ğŸ‹",name:"æŸ æª¬",buyPrice:4,sellPrice:7,weight:1,boxSize:20,transportTime:2e3,demand:1.3},{id:"kiwi",emoji:"ğŸ¥",name:"çŒ•çŒ´æ¡ƒ",buyPrice:7,sellPrice:11,weight:2,boxSize:20,transportTime:3500,demand:.2},{id:"pineapple",emoji:"ğŸ",name:"è è",buyPrice:9,sellPrice:14,weight:6,boxSize:8,transportTime:5e3,demand:.9},{id:"cherry",emoji:"ğŸ’",name:"æ¨±æ¡ƒ",buyPrice:10,sellPrice:16,weight:1,boxSize:30,transportTime:6e3,demand:1.6},{id:"pear",emoji:"ğŸ",name:"æ¢¨å­",buyPrice:6,sellPrice:9,weight:2,boxSize:20,transportTime:3e3,demand:1.2},{id:"hamburger",emoji:"ğŸ”",name:"æ±‰å ¡",buyPrice:8,sellPrice:13,weight:1,boxSize:25,transportTime:4500,demand:1.4},{id:"avocado",emoji:"ğŸ¥‘",name:"ç‰›æ²¹æœ",buyPrice:9,sellPrice:14,weight:5,boxSize:10,transportTime:5e3,demand:.8},{id:"greenapple",emoji:"ğŸ",name:"é’è‹¹æœ",buyPrice:5,sellPrice:8,weight:2,boxSize:20,transportTime:5e3,demand:1},{id:"tangerine",emoji:"ğŸŠ",name:"æ©˜å­",buyPrice:5,sellPrice:9,weight:2,boxSize:20,transportTime:3e3,demand:2.3},{id:"coconut",emoji:"ğŸ¥¥",name:"æ¤°å­",buyPrice:10,sellPrice:15,weight:6,boxSize:6,transportTime:6e3,demand:.7},{id:"corn",emoji:"ğŸŒ½",name:"ç‰ç±³",buyPrice:11,sellPrice:17,weight:7,boxSize:5,transportTime:7e3,demand:.6},{id:"bread",emoji:"ğŸ",name:"é¢åŒ…",buyPrice:7,sellPrice:12,weight:3,boxSize:18,transportTime:4500,demand:3}],Y=we({money:2e3,carryingCapacity:50,incomingShipments:[],workerSpeed:3}),N=we({level:1,exp:0});function Ge(c,u,y){const g=j.find(v=>v.id===c);if(!g)return{error:"å•†å“ä¸å­˜åœ¨"};const i=g.buyPrice*g.boxSize*u;if(y<u)return{error:"å…¥åº“åŒºç©ºé—´ä¸è¶³"};if(Y.money<i)return{error:"èµ„é‡‘ä¸è¶³"};Y.money-=i;const p=Date.now()+g.transportTime;return Y.incomingShipments.push({productId:c,boxCount:u,eta:p,startTime:Date.now()}),{success:!0}}function Le(c,u,y){const g=Date.now(),i=[];for(const p of Y.incomingShipments)p.eta<=g?Ze(c,u,y,p.productId,p.boxCount)||alert("å…¥åº“å¤±è´¥ï¼Œç©ºé—´ä¸è¶³"):i.push(p);Y.incomingShipments=i}function Ze(c,u,y,g,i){const p=j.find(f=>f.id===g);if(!p)return!1;let v=0;for(let f=0;f<c.length;f++)for(let d=0;d<c[0].length;d++){if(v>=i)return!0;const e=u[f][d],r=c[f][d];e===y&&r===null&&(c[f][d]={type:"goods",productId:g,count:p.boxSize},v++)}return v===i}function Ue(c,u,y){let g=0;for(let i=0;i<c.length;i++)for(let p=0;p<c[0].length;p++)u[i][p]===y&&c[i][p]===null&&g++;return g}const se=1,q=0,re=2,ie=3;function Ve(c,u){const y=j.slice(0,N.level+2);for(let g=0;g<u.length;g++)for(let i=0;i<u[0].length;i++)if(u[g][i]===1&&Math.random()<.05){const p=y[Math.floor(Math.random()*y.length)];c[g][i]={type:"goods",productId:p.id,count:Math.floor(p.boxSize*(Math.random()*.5+.5))}}}function Je(c,u){const y=Array.from({length:c},()=>Array(u).fill(q)),g=4,i=2,p=1,v=4;for(let f=0;f<g;f++){const d=v+f*(i+p);for(let e=d;e<d+i;e++)for(let r=1;r<=10;r++)y[e][r]=se;for(let e=d;e<d+i;e++)for(let r=15;r<=24;r++)y[e][r]=se;for(let e=d;e<d+i;e++)for(let r=u-11;r<=u-2;r++)y[e][r]=se;for(let e=18;e<=21;e++)y[0][e]=re;for(let e=18;e<=21;e++)y[c-1][e]=ie}return y}function Ke(c){return c.map(u=>({v:u,sort:Math.random()})).sort((u,y)=>u.sort-y.sort).map(({v:u})=>u)}let be=1;function Qe(){const u=`ORD-${new Date().toISOString().slice(0,10).replace(/-/g,"")}-${String(be).padStart(3,"0")}`;return be++,u}function Te(){const c=Math.floor(Math.random()*3)+1,y=j.slice(0,N.level+2).flatMap(p=>Array(Math.floor(p.demand*10)).fill(p)),i=[...new Set(Ke(y))].slice(0,c).map(p=>{const v=Math.ceil(Math.random()*p.boxSize);return{productId:p.id,count:v}});return{id:Qe(),items:i,expires:Date.now()+18e4}}function et(c,u,y){const g={};for(let v=0;v<u.length;v++)for(let f=0;f<u[0].length;f++)if(y[v][f]===ie){const d=u[v][f];if(d&&d.type==="goods"){const e=d.productId;g[e]=(g[e]||0)+d.count}}for(const v of c.items)if(!g[v.productId]||g[v.productId]<v.count)return{success:!1,reason:"åº“å­˜ä¸è¶³"};for(const v of c.items){let f=v.count;for(let d=0;d<u.length;d++){for(let e=0;e<u[0].length;e++)if(y[d][e]===ie){const r=u[d][e];if(r&&r.type==="goods"&&r.productId===v.productId){const O=Math.min(f,r.count);if(r.count-=O,f-=O,r.count<=0&&(u[d][e]=null),f<=0)break}}if(f<=0)break}}const i=c.items.reduce((v,f)=>{const d=j.find(e=>e.id===f.productId);return v+((d==null?void 0:d.sellPrice)||0)*f.count},0),p=Math.floor(c.items.reduce((v,f)=>{var e;const d=((e=j.find(r=>r.id===f.productId))==null?void 0:e.demand)||1;return v+1/d*10},0)+Math.random()*10);return Y.money+=i+p,{success:!0,earned:i,bonus:p,total:i+p}}function tt(c,u,y,g,i,p,v,f,d){for(let e=0;e<p;e++)for(let r=0;r<v;r++){const O=(r-g.x)*i,A=(e-g.y)*i;if(O+i<0||O>f||A+i<0||A>d)continue;const Z=u[e][r],W=y[e][r];switch(Z){case 1:c.fillStyle="#888";break;case 2:c.fillStyle="#aaf";break;case 3:c.fillStyle="#afa";break;default:c.fillStyle="#f0f0f0";break}if(c.fillRect(O,A,i,i),c.strokeStyle="#ccc",c.strokeRect(O,A,i,i),(W==null?void 0:W.type)==="goods"){const ee=j.find(F=>F.id===W.productId);ee&&(c.font=`${i*.6}px serif`,c.textAlign="center",c.textBaseline="middle",c.fillText(ee.emoji,O+i*.5,A+i*.5),c.font="12px sans-serif",c.textAlign="right",c.textBaseline="bottom",c.fillStyle="#fff",c.fillRect(O+i-28,A+i-18,26,16),c.fillStyle="#000",c.fillText(`Ã—${W.count}`,O+i-4,A+i-4))}}}const ne=[{level:1,expNeeded:100,expTotal:100},{level:2,expNeeded:120,expTotal:220},{level:3,expNeeded:144,expTotal:364},{level:4,expNeeded:172,expTotal:536},{level:5,expNeeded:207,expTotal:743},{level:6,expNeeded:248,expTotal:991},{level:7,expNeeded:298,expTotal:1289},{level:8,expNeeded:358,expTotal:1647},{level:9,expNeeded:429,expTotal:2076},{level:10,expNeeded:515,expTotal:2591},{level:11,expNeeded:619,expTotal:3210},{level:12,expNeeded:743,expTotal:3953},{level:13,expNeeded:891,expTotal:4844},{level:14,expNeeded:1069,expTotal:5913},{level:15,expNeeded:1283,expTotal:7196},{level:16,expNeeded:1540,expTotal:8736},{level:17,expNeeded:1848,expTotal:10584},{level:18,expNeeded:2218,expTotal:12802},{level:19,expNeeded:2662,expTotal:15464},{level:20,expNeeded:3194,expTotal:18658}],nt={class:"sidebar"},ot={class:"level-bar"},lt={class:"money-display"},at={class:"tabs"},st=["onClick"],rt={class:"sidebar-content"},it={key:0},ct={key:0},ut=["title"],dt={class:"name"},ft={class:"note"},vt=["onClick"],pt={key:1,class:"locked"},mt={key:1,style:{padding:"16px"}},gt={class:"order-header"},ht={class:"order-items"},yt={class:"order-bonus"},xt={class:"order-total"},_t=["onClick"],bt={class:"progress-bar"},Tt={key:2},wt=["title"],kt={class:"emoji"},Pt={class:"count-overlay"},St={class:"name"},Mt={class:"value"},It={class:"inventory-total"},I=40,D=20,B=40,Ct={__name:"Game",setup(c){const u=X(null);let y=800,g=512,i=0,p=0;const v=X({x:0,y:0}),f=X(Je(D,B)),d=X(Array.from({length:D},()=>Array(B).fill(null))),e=X({gx:6,gy:6,px:0,py:0,path:[],carrying:null,target:null,message:null,messageType:"error",messageTimer:0});let r=null,O=null,A=0,Z=0;const W=X(null),ee=["å…¥åº“","å‡ºåº“","åº“å­˜"],F=X("å…¥åº“"),oe=X(Y.money);J(()=>j.slice(0,N.level+2));const H=X([]),ce=J(()=>{const t=ne.find(o=>o.level===N.level);return(t==null?void 0:t.expNeeded)||99999}),ke=J(()=>Math.min(100,N.exp/ce.value*100));function Pe(t){for(N.exp+=t;N.level<ne.length&&N.exp>=ne[N.level-1].expNeeded;)N.exp-=ne[N.level-1].expNeeded,N.level++,Y.workerSpeed+=1,L("Level upï¼","success")}function ue(){const n=3e4*Math.exp(-.15*(N.level-1));return Math.max(1e3,Math.floor(n))}function U(t){return j.find(o=>o.id===t)||{}}function de(t){const n=t.items.reduce((a,s)=>{const m=U(s.productId).demand||1;return a+Math.floor(1/m*10)},0),l=t.items.length*5;return 5+n+l}function Se(t){return t.items.reduce((n,l)=>{const a=U(l.productId).sellPrice||0;return n+l.count*a},0)+de(t)}function Me(t){const n=t.expires-Date.now();return 100-Math.min(100,Math.max(0,(6e4-n)/6e4*100))}const Ie=J(()=>Object.values(fe.value).reduce((t,o)=>t+o.value,0));function je(){function t(){const o=Te();H.value.push(o);const n=Math.floor(Math.random()*1e4)+ue();setTimeout(t,n)}H.value=[Te()],setTimeout(t,ue())}setInterval(()=>{const t=Date.now();H.value=H.value.filter(o=>o.expires>t)},1e3);const fe=J(()=>{const t={};for(let o of d.value)for(let n of o)if(G(n)){const l=j.find(s=>s.id===n.productId);if(!l)continue;const a=l.boxSize;t[l.id]?(t[l.id].count+=a,t[l.id].value+=a*l.sellPrice):t[l.id]={count:a,emoji:l.emoji,name:l.name,value:a*l.sellPrice}}return t});function ve(t){const o=j.find(n=>n.name===t);return o?`åç§°: ${o.name}
  æ¯ç®±: ${o.boxSize}ä¸ª
  é‡é‡: ${o.weight}
  è¿›ä»·: Â¥${o.buyPrice}
  å”®ä»·: Â¥${o.sellPrice}
  è¿è¾“: ${o.transportTime/1e3}s
  éœ€æ±‚æŒ‡æ•°: ${o.demand}`:""}function Ce(t){const o=Ue(d.value,f.value,re),n=Ge(t,1,o);n.error&&alert(n.error)}function Ne(){const t=i/2,o=p/2,n=e.value.gx,l=e.value.gy;let a=n-t,s=l-o;a<0&&(a=0),a>B-i&&(a=B-i),s<0&&(s=0),s>D-p&&(s=D-p),v.value.x=a,v.value.y=s}function $e(){const t=e.value.px-v.value.x*I,o=e.value.py-v.value.y*I;if(r.font=`${I*.9}px serif`,r.textAlign="center",r.textBaseline="middle",r.fillText("ğŸ‘·",t,o),e.value.message&&e.value.messageTimer>0&&(Be(r,e.value.message,t,o,e.value.messageType),e.value.messageTimer--,e.value.messageTimer===0&&(e.value.message=null)),e.value.carrying){const n=j.find(l=>l.id===e.value.carrying.productId);n&&(r.font="20px serif",r.fillText(n.emoji,t,o+14),r.fillStyle="#fff",r.fillRect(t+10,o+15,26,14),r.font="10px sans-serif",r.fillStyle="#000",r.fillText(`Ã—${e.value.carrying.count}`,t+22,o+24))}}function ze(){const t=Date.now(),o=120,n=16;Y.incomingShipments.forEach((l,a)=>{const s=j.find(w=>w.id===l.productId);if(!s)return;const m=l.eta-(l.startTime||l.eta-s.transportTime),x=1-(l.eta-t)/m,h=y-150,T=30+a*(n+10);r.fillStyle="#ddd",r.fillRect(h,T,o,n),r.fillStyle="#76c7c0",r.fillRect(h,T,o*x,n),r.font="16px serif",r.fillStyle="#000",r.fillText(s.emoji+" Ã—"+l.boxCount,h-80,T+14)})}function pe(){var t;if(r.clearRect(0,0,u.value.width,u.value.height),tt(r,f.value,d.value,v.value,I,D,B,y,g),Re(),Ne(),$e(),ze(),Le(d.value,f.value,re),O=requestAnimationFrame(pe),e.value.target){const[o,n]=e.value.target,l=(t=d.value[n])==null?void 0:t[o],a=e.value.__targetMode,s=e.value.carrying;if(a==="pickup"){if(!G(l)){e.value.target=null;return}if(e.value.__tick||(e.value.__tick=0),e.value.__tick++,e.value.__tick>=5){const m=l.productId;j.find(x=>x.id===m)&&(s?s.count++:e.value.carrying={productId:m,count:1},l.count--,l.count<=0&&(d.value[n][o]=null,e.value.target=null)),e.value.__tick=0}}else if(a==="dropoff"){if(!s){e.value.target=null;return}const m=j.find(_=>_.id===s.productId);if(!m)return;if(e.value.__tick||(e.value.__tick=0),e.value.__tick++,e.value.__tick>=5){if(G(l)){if(l.productId!==s.productId){L("å•†å“ç±»å‹ä¸ä¸€è‡´"),e.value.target=null;return}if(l.count>=m.boxSize){L("æ­¤æ ¼å·²æ»¡"),e.value.target=null;return}l.count++}else d.value[n][o]={type:"goods",productId:s.productId,count:1};s.count--,s.count<=0&&(e.value.carrying=null,e.value.target=null),e.value.__tick=0}}}if(W.value){const{x:o,y:n,productId:l}=W.value,a=j.find(s=>s.id===l);if(a){const m=`
      ${a.name}
      è¿›ä»·: Â¥${a.buyPrice}
      å”®ä»·: Â¥${a.sellPrice}
      é‡é‡: ${a.weight}
      `.split(`
`),_=m.length*18+10;r.fillStyle="rgba(0,0,0,0.75)",r.fillRect(o+10,n+10,80,_),r.fillStyle="#fff",r.font="13px sans-serif",m.forEach((x,h)=>{r.fillText(x,o+36,n+28+h*16)})}}}function me(){var x;const{gx:t,gy:o}=e.value,n=e.value.__targetGoods;if(!n)return;const[l,a]=n,s=Math.abs(t-l),m=Math.abs(o-a),_=(x=d.value[a])==null?void 0:x[l];(s===1&&m===0||s===0&&m===1)&&(e.value.__targetMode==="pickup"&&G(_)&&_.count>0&&(e.value.target=[l,a],e.value.__tick=0),e.value.__targetMode==="dropoff"&&e.value.carrying&&(e.value.target=[l,a],e.value.__tick=0)),console.log("afterArrivedTile",e.value.target,e.value.__targetGoods,e.value.carrying),e.value.__targetGoods=null}function Re(){const t=Y.workerSpeed;if(e.value.path.length>0){const[o,n]=e.value.path[0],l=o*I+I/2,a=n*I+I/2,s=l-e.value.px,m=a-e.value.py,_=Math.sqrt(s*s+m*m);if(_<t){if(e.value.px=l,e.value.py=a,e.value.gx=o,e.value.gy=n,e.value.gx<0||e.value.gy<0||e.value.gx>=B||e.value.gy>=D){console.warn("å·¥äººè¶Šç•Œ:",e.value.gx,e.value.gy),e.value.path=[];return}e.value.path.shift(),me()}else e.value.px+=s/_*t,e.value.py+=m/_*t}}function Oe(t){const o=et(t,d.value,f.value);o.success?(H.value=H.value.filter(n=>n.id!==t.id),Pe(o.total)):L("å°šæœªæ»¡è¶³è®¢å•æ¡ä»¶ï¼")}function ge(t,o,n){const a=[[t+1,o],[t-1,o],[t,o+1],[t,o-1]].filter(([h,T])=>h>=0&&T>=0&&h<B&&T<D&&f.value[T][h]===q),{gx:s,gy:m}=e.value;for(const[h,T]of a)if(h===s&&T===m){e.value.__targetGoods=[t,o],e.value.__targetMode=n,e.value.path=[],me(),console.log(e.value.__targetGoods,e.value.__targetMode,e.value.path);return}let _=null,x=[];for(const[h,T]of a){const w=ae([e.value.gx,e.value.gy],[h,T]);w.length&&(!_||w.length<x.length)&&(_=[h,T],x=w)}e.value.__targetGoods=[t,o],e.value.__targetMode=n,_&&x&&(e.value.path=x)}function le(t){var w,k;const o=u.value.getBoundingClientRect(),n=t.clientX-o.left,l=t.clientY-o.top,a=Math.floor(n/I+v.value.x),s=Math.floor(l/I+v.value.y);if(a<0||s<0||a>=B||s>=D){console.warn("å·¥äººè¶Šç•Œ:",a,s);return}let m=a,_=s;if(((w=f.value[s])==null?void 0:w[a])!==q){const P=[[a+1,s],[a-1,s],[a,s+1],[a,s-1]];let S=null,E=[];for(const[R,C]of P)if(R>=0&&C>=0&&R<B&&C<D&&f.value[C][R]===q){const V=ae([e.value.gx,e.value.gy],[R,C]);V.length&&(!S||V.length<E.length)&&(S=[R,C],E=V)}S?(m=S[0],_=S[1]):console.warn("æ²¡æœ‰å¯è¾¾è·¯å¾„")}e.value.target=null;const x=(k=d.value[s])==null?void 0:k[a],h=e.value.carrying;if(G(x)){console.warn("isGoodsCell",h),!h||h.productId===x.productId?ge(a,s,"pickup"):L("å•†å“ç±»å‹ä¸ä¸€è‡´");return}const T=ae([e.value.gx,e.value.gy],[m,_]);T.length>0&&(e.value.path=T)}function Ae(t){var T,w;t.preventDefault();const o=u.value.getBoundingClientRect(),n=t.clientX-o.left,l=t.clientY-o.top,a=Math.floor(n/I+v.value.x),s=Math.floor(l/I+v.value.y);if(a<0||s<0||a>=B||s>=D){console.warn("å·¥äººè¶Šç•Œ:",a,s);return}const m=(T=f.value[s])==null?void 0:T[a],_=(w=d.value[s])==null?void 0:w[a],x=e.value.carrying;if(m===q||!x)return;if(!(_==null||_.type==="goods"&&_.productId===x.productId)){L("å•†å“ç±»å‹ä¸ä¸€è‡´");return}ge(a,s,"dropoff")}function De(t){var s;const o=u.value.getBoundingClientRect();A=t.clientX-o.left,Z=t.clientY-o.top;const n=Math.floor(A/I+v.value.x),l=Math.floor(Z/I+v.value.y),a=(s=d.value[l])==null?void 0:s[n];G(a)?W.value={x:A,y:Z,productId:a.productId}:W.value=null}function ae(t,o){const[n,l]=t,[a,s]=o,m=[[n,l]],_={},x={},h=(k,P)=>`${k},${P}`;for(_[h(n,l)]=null,x[h(n,l)]=0;m.length;){m.sort((S,E)=>x[h(S[0],S[1])]+he(S,o)-(x[h(E[0],E[1])]+he(E,o)));const[k,P]=m.shift();if(k===a&&P===s)break;for(const[S,E]of[[1,0],[-1,0],[0,1],[0,-1],[1,1],[-1,1],[1,-1],[-1,-1]]){const R=k+S,C=P+E;if(R<0||C<0||R>=B||C>=D||f.value[C][R]!==q)continue;if(Math.abs(S)+Math.abs(E)===2){const Ye=f.value[P][C]!==q,We=f.value[C][k]!==q;if(Ye||We)continue}const V=S===0||E===0?1:1.4,ye=x[h(k,P)]+V;(!(h(R,C)in x)||ye<x[h(R,C)])&&(x[h(R,C)]=ye,_[h(R,C)]=[k,P],m.push([R,C]))}}const T=[];let w=[a,s];for(;w&&h(w[0],w[1])!==h(n,l);)T.unshift(w),w=_[h(w[0],w[1])];return T}function he(t,o){return Math.abs(t[0]-o[0])+Math.abs(t[1]-o[1])}function G(t){return t&&typeof t=="object"&&t.type==="goods"}function L(t,o="error",n=60){e.value.message=t,e.value.messageTimer=n,e.value.messageType=o}function Be(t,o,n,l,a="error"){const x=`${a==="success"?"ğŸ˜„":"âŒ"} ${o}`;t.font="14px sans-serif";const T=t.measureText(x).width+8*2,w=22,k=n-T/2,P=l-60,S=6;t.beginPath(),t.moveTo(k+S,P),t.lineTo(k+T-S,P),t.quadraticCurveTo(k+T,P,k+T,P+S),t.lineTo(k+T,P+w-S),t.quadraticCurveTo(k+T,P+w,k+T-S,P+w),t.lineTo(k+S,P+w),t.quadraticCurveTo(k,P+w,k,P+w-S),t.lineTo(k,P+S),t.quadraticCurveTo(k,P,k+S,P),t.closePath(),t.fillStyle=a==="success"?"rgba(240,255,240,0.95)":"rgba(255,255,255,0.95)",t.fill(),t.strokeStyle=a==="success"?"#4caf50":"#999",t.stroke(),t.fillStyle="#000",t.textAlign="center",t.textBaseline="middle",t.fillText(x,n,P+w/2)}return Ee(()=>{y=window.innerWidth-500,g=window.innerHeight-100,u.value.width=y,u.value.height=g,i=Math.floor(y/I),p=Math.floor(g/I),r=u.value.getContext("2d"),e.value.px=e.value.gx*I+I/2,e.value.py=e.value.gy*I+I/2,u.value.addEventListener("click",le),Ve(d.value,f.value),pe(),je()}),Xe(()=>{cancelAnimationFrame(O),u.value.removeEventListener("click",le)}),qe(()=>Y.money,(t,o)=>{const a=16.666666666666668,s=(t-o)/30;let m=o,_=0;const x=setInterval(()=>{m+=s,oe.value=Math.round(m),_++,_>=30&&(oe.value=t,clearInterval(x))},a)}),(t,o)=>(z(),$("div",{class:"warehouse-canvas-game",onMousemove:De},[b("canvas",{ref_key:"canvasRef",ref:u,onClick:le,onContextmenu:Fe(Ae,["prevent"])},null,544),b("div",nt,[b("h3",null,"ğŸ–ï¸ ç­‰çº§ï¼š"+M(te(N).level),1),b("p",null,"ç»éªŒå€¼ï¼š"+M(te(N).exp)+" / "+M(ce.value),1),b("div",ot,[b("div",{class:"level-bar-inner",style:xe({width:ke.value+"%"})},null,4)]),b("div",lt,"ğŸ’°èµ„é‡‘: Â¥"+M(oe.value),1),b("div",at,[(z(),$(K,null,Q(ee,n=>b("button",{key:n,onClick:l=>F.value=n,class:He({active:F.value===n})},M(n),11,st)),64))]),b("div",rt,[F.value==="å…¥åº“"?(z(),$("div",it,[(z(!0),$(K,null,Q(te(j),(n,l)=>(z(),$("div",{key:n.id,class:"product-entry"},[l<=te(N).level+1?(z(),$("div",ct,[b("span",{class:"emoji",title:ve(n.name)},M(n.emoji),9,ut),b("span",dt,M(n.name),1),b("span",ft,M(n.boxSize)+"ä¸ª/ç®±",1),b("button",{class:"price-btn",onClick:a=>Ce(n.id)},"Â¥"+M(n.boxSize*n.buyPrice),9,vt)])):(z(),$("div",pt," ğŸ”’ "+M(n.name)+"ï¼ˆLv."+M(l-2)+" è§£é”ï¼‰ ",1))]))),128))])):_e("",!0),F.value==="å‡ºåº“"?(z(),$("div",mt,[(z(!0),$(K,null,Q(H.value,n=>(z(),$("div",{key:n.id,class:"order-card"},[b("div",gt,[b("span",null,"ğŸ§¾ è®¢å• "+M(n.id),1)]),b("div",ht,[(z(!0),$(K,null,Q(n.items,l=>(z(),$("div",{key:l.productId,class:"order-item"},[b("span",null,M(U(l.productId).emoji)+M(U(l.productId).name),1),b("span",null,"Â¥ "+M(U(l.productId).sellPrice),1),b("span",null,"Ã— "+M(l.count),1)]))),128))]),b("div",yt,"ğŸ å¥–é‡‘: Â¥"+M(de(n)),1),b("div",xt,"ğŸ’µ æ€»æ”¶å…¥: Â¥"+M(Se(n)),1),b("button",{class:"complete-btn",onClick:l=>Oe(n)}," Â Â Â å®ŒæˆÂ Â Â  ",8,_t),b("div",bt,[b("div",{class:"progress-fill",style:xe({width:Me(n)+"%"})},null,4)])]))),128))])):F.value==="åº“å­˜"?(z(),$("div",Tt,[(z(!0),$(K,null,Q(fe.value,(n,l)=>(z(),$("div",{key:l,class:"stock-line"},[b("div",{class:"emoji-wrapper",title:ve(n.name)},[b("span",kt,M(n.emoji),1),b("span",Pt,"Ã—"+M(n.count),1)],8,wt),b("span",St,M(n.name),1),b("span",Mt,"ä¼°å€¼: Â¥"+M(n.value),1)]))),128)),b("div",It," ğŸ’° æ€»ä¼°å€¼: Â¥"+M(Ie.value),1)])):_e("",!0)])])],32))}};export{Ct as default};
